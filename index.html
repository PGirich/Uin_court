<style>
  .thumb {
    height: 75px;
    border: 1px solid #000;
    margin: 10px 5px 0 0;
  }

  div {
    margin-bottom: 10px;
    padding-bottom: 10px;
    padding-left: 10px;
    padding-right: 10px;
    padding-top: 1px;
  }
  div#border {
    border: 1px dotted red;
    margin: 20px;
  }
  div#outline {
    outline: 1px solid red;
    outline-offset: -2px;
  }
</style>

<div id="outline">
  <p>
    Сформировать УИН ФССП России для судебного акта, администрируемого ФССП России, по запросу суда
  </p>
  <p>
    <a
      href="https://fssp.gov.ru/files/fssp/db/files/00smev2022/trebovaniya_k_formirovaniu_uin_v4_20220620_20226271547.pdf"
      >Требования к формированию уникального идентификатора начислений в
      документах ФССП России, предназначенного для идентификации начисления</a
    >, опубликованы на
    <a href="https://fssp.gov.ru/mvv_fssp/">сайте ФССП России</a>. Согласно
    данных требований для формирования УИН достаточно знания номера
    дела по администрированию доходов бюджета, сформированного на основании запроса суда и зарегистрированного территориальным органом ФССП России - администратором дохода под номером, соответствующим регистрационному номеру входящего документа - запроса суда, в формате n..n/yy/rr0dd .
  </p>
</div>
<div id="border">
  <p class="name">Укажите регистрационный номер входящего запроса суда о предоставлении УИН для получения УИН, или УИН для получения номера запроса суда</p>
  <label for="editboxIP">Вх.№ запроса: </label>
  <input
    type="text"
    id="editboxIP"
    value="123456/06/24000"
    placeholder="n..n/yy/rr000"
  />
  <>
  <label for="editboxUIN">УИН суд.акта: </label>
  <input
    type="text"
    id="editboxUIN"
    value="32224012060123456005"
    placeholder="322....00 (20 цифр)"
  />
  <br><h5>
  <label id="labelUINType"></label>
</div>

<script>
  //===========================
  // Контрольный разряд уникального идентификатора начисления рассчитывается в следующем порядке:
  // каждому разряду уникального идентификатора начисления (первые 19 разрядов для 20-значного либо первые 24 разряда для 25-значного уникального идентификатора начисления), начиная со старшего разряда, присваивается весовой коэффициент, соответствующий повторяющемуся ряду чисел от 1 до 10;
  // рассчитываются произведения значений разрядов на соответствующие весовые коэффициенты и вычисляется сумма полученных произведений;
  // контрольный разряд уникального идентификатора начисления представляет собой остаток от деления полученной суммы на модуль 11 и должен иметь значение от 0 до 9;
  // если полученный остаток равен 10, проводится повторный расчет с применением второй последовательности весовых коэффициентов, являющейся результатом циклического сдвига исходной последовательности на два разряда влево (3, 4, 5, 6, 7, 8, 9, 10, 1, 2);
  // в случае если при повторном расчете остаток от деления вновь сохраняется равным 10, то значение контрольного разряда признается равным нулю ("0").
  //===========================
  // Получить контрольный разряд УИН
  function getControlSum(strUin, startVes) {
    var controlSum = 0;
    for (var i = 0; i < strUin.length; i++) {
      var ves = ((i + startVes - 1) % 10) + 1;
      controlSum += Number(strUin[i]) * ves;
      //spanText = spanText + '<br> ==> ' + strUin[i] + ' -> ' + ves;
    }
    return controlSum % 11;
  }

  //===========================
  // Получить УИН по номеру
  function getUin(lninp) {
    // Выделяем фрагменты номера
    var aln = lninp.toUpperCase().trim().split('/');
    var docNo = '';
    var docYr = '';
    var docDep = aln2[0];
    if (aln.length > 0) docNo = aln[0];
    if (aln.length > 1) docYr = aln[1];
    if (aln.length > 2) docDep = aln2[0];
    // Простейшая валидация элементов номера
    var invalidNo =
      Number(docNo) < 1 ||
      Number(docNo) > 9999999 ||
      !(docYr.length == 2) ||
      !(docDep.length == 5);
    var uin = 'Неверно указан номер исполнительного производства '; //+ipno+' '+ipyr+' '+ipdp1+' '+ipdp2 ;
    // Для валидного номера ИП рассчитываем УИН
    if (!invalidNo) {
      var uin19 = '322' + docDep + docYr + ('0000' + docNo).slice(-7) + '11';
      var crc = getControlSum(uin19, 1);
      if (crc == 10) {
        crc = getControlSum(uin19, 3);
        if (crc == 10) {
          crc = 0;
        }
      }
      uin = uin19 + crc;
    }
    return uin;
  }

  //===========================
  // Получить номер запроса по УИН
  function getNo(lninp) {
    // Выделяем фрагменты номера ИП
    no =
      lninp.substring(10, 17).replace(/^0+/, '') +
      '/' +
      lninp.substring(8, 10) +
      '/' +
      lninp.substring(3, 8);
    return no;
  }

  //===========================
  // Отобразить тип УИН
  function detectUINType() {
    let uin = document.getElementById('editboxUIN').value;
    let uinType = uin.substring(17, 19);
    let uinid = uinTypeId.indexOf(uinType);
    document.getElementById('labelUINType').innerHTML = '* Тип УИН: '+ uinTypeName[uinid];
  }

  //===========================
  // Обработка поля ввода
  function handleInputBoxNo(evt) {
    var ln = evt.target.value;
    document.getElementById('editboxUIN').value = getUin(ln);
    detectUINType('editboxUIN');
  }
  function handleInputBoxUIN(evt) {
    var ln = evt.target.value;
    document.getElementById('editboxIP').value = getIP(ln);
    detectUINType();
  }

  // тело скрипта

  // определяем массив видов начисление
  const uinTypeId = ['00','01','02','03','04','05','06','07','08','09','10','11'];
  const uinTypeName = [
    'Взыскания по исполнительным производствам',
    'Денежные взыскания Российской Федерации об административных правонарушениях, по делам, подведомственным ФССП России',
    'Возмещение расходов по совершению исполнительских действий, осуществленных Федеральной службой судебных приставов за счет средств федерального бюджета (исполнительские действия в бюджет)','Прочие поступления от денежных взысканий (штрафов) и иных сумм в возмещение ущерба, зачисляемые в федеральный бюджет (материальный ущерб)',
    'Исполнительский сбор',
    'Денежные средства, поступающие от реализации конфискованного имущества/обращения в доход государства',
    'Денежные взыскания (штрафы), установленные УК РФ (уголовные штрафы)',
    'Доходы, поступающие в порядке возмещения федеральному бюджету средств, выплаченных на покрытие процессуальных издержек (процессуальные издержки)',
    'Доходы, поступающие в порядке компенсации затрат на мероприятия, проводимые за счет бюджета (компенсация затрат)',
    'Иные взыскания имущественного характера в пользу бюджетной системы РФ',
    'Денежные взыскания, налагаемые судами (судебные штрафы)',
    'Денежные взыскания (штрафы), установленные Кодексом Российской Федерации об административных правонарушениях, по делам, не подведомственным ФССП России'
  ];

  // установка обработчиков событий
  document
    .getElementById('editboxNo')
    .addEventListener('input', handleInputBoxIP, false);
  document
    .getElementById('editboxUIN')
    .addEventListener('input', handleInputBoxUIN, false);

</script>
